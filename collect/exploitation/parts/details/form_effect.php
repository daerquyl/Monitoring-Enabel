<script>
$(document).ready(function(){
	//Script pour mettre a jour les valeurs actuelles de la $collecte dans le formulaire
	$('.record-card #id').val("<?= $collect['id'] ?>").trigger("change");
	$('.record-card #collect_id').val("<?= $collect['id'] ?>").trigger("change");
	$('.record-card #site_id').val("<?= $collect['site_id'] ?>").trigger("change");
	$('.record-card #polarized_villages').val("<?= $collect['polarized_villages'] ?>").trigger("change");

	$('.record-card #owner_name').val("<?= $collect['owner_name'] ?>").trigger("change");
	$('.record-card #owner_address').val("<?= $collect['owner_address'] ?>").trigger("change");
	$('.record-card #parcel_code').val("<?= $collect['parcel_code'] ?>").trigger("change");
	$('.record-card #age').val("<?= $collect['age'] ?>").trigger("change");	
	$('.record-card #owner_sex').val("<?= $collect['owner_sex'] ?>").trigger("change");
	$('.record-card #owner_nid').val("<?= $collect['owner_nid'] ?>").trigger("change");
	$('.record-card #owner_phone').val("<?= $collect['owner_phone'] ?>").trigger("change");
	$('.record-card #owner_experienced_years').val("<?= $collect['owner_experienced_years'] ?>").trigger("change");
	$('.record-card #allocated_area').val("<?= $collect['allocated_area'] ?>").trigger("change");
	$('.record-card #mr').val("<?= getTrueOrFalse($collect['mr']) ?>").trigger("change");
	$('.record-card #pvh').val("<?= getTrueOrFalse($collect['pvh']) ?>").trigger("change");
	$('.record-card #parcel_unity').val("<?= $collect['parcel_unity'] ?>").trigger("change");	
	$('.record-card #op_member').val("<?= getTrueOrFalse($collect['op_member']) ?>").trigger("change");
	$('.record-card #op').val("<?= $collect['op'] ?>").trigger("change");
	$('.record-card #created_before_pareba').val("<?= getTrueOrFalse($collect['created_before_pareba']) ?>").trigger("change");
	$('.record-card #trained_by_pareba').val("<?= getTrueOrFalse($collect['trained_by_pareba']) ?>").trigger("change");

	$('.record-card #reporting_period').val("<?= $collect['reporting_period'] ?>").trigger("change");
	$('.record-card #exploitation_start_date').val("<?= $collect['exploitation_start_date'] ?>").trigger("change");
	$('.record-card #exploitation_end_date').val("<?= $collect['exploitation_end_date'] ?>").trigger("change");
	$('.record-card #used_good_practises').val("<?= getTrueOrFalse($collect['used_good_practises']) ?>").trigger("change");	
	$('.record-card #soil_preparation_amount').val("<?= $collect['soil_preparation_amount'] ?>").trigger("change");
	$('.record-card #seeds_amount').val("<?= $collect['seeds_amount'] ?>").trigger("change");
	$('.record-card #organic_fertilizer_cost').val("<?= $collect['organic_fertilizer_cost'] ?>").trigger("change");
	$('.record-card #mineral_fertilizer_cost').val("<?= $collect['mineral_fertilizer_cost'] ?>").trigger("change");
	$('.record-card #phytosanitizer_cost').val("<?= $collect['phytosanitizer_cost'] ?>").trigger("change");
	$('.record-card #agricultural_equipment_cost').val("<?= $collect['agricultural_equipment_cost'] ?>").trigger("change");
	$('.record-card #agricultural_equipment_maintenance_cost').val("<?= $collect['agricultural_equipment_maintenance_cost'] ?>").trigger("change");
	$('.record-card #irrigation_network_cost').val("<?= $collect['irrigation_network_cost'] ?>").trigger("change");
	$('.record-card #royalties_payed').val("<?= $collect['royalties_payed'] ?>").trigger("change");
	$('.record-card #salary_payed').val("<?= $collect['salary_payed'] ?>").trigger("change");
	$('.record-card #credit_repayment_amount').val("<?= $collect['credit_repayment_amount'] ?>").trigger("change");
	$('.record-card #cooperative_contribution_amount').val("<?= $collect['cooperative_contribution_amount'] ?>").trigger("change");
	$('.record-card #other_amount').val("<?= $collect['other_amount'] ?>").trigger("change");
	$('.record-card #other_amount_description').val("<?= $collect['other_amount_description'] ?>").trigger("change");

	$('.record-card #out_of_scope_revenue').val("<?= $collect['out_of_scope_revenue'] ?>").trigger("change");
	$('.record-card #manager_revenue').val("<?= $collect['manager_revenue'] ?>").trigger("change");
	$('.record-card #worked_campaigns').val("<?= $collect['worked_campaigns'] ?>").trigger("change");
		
	<?php
		require_once("commons/support_form_effect.php");
		$supports = $collect['support'];
		$capacity_building = getTrueOrFalse($collect['capacity_building']);
		$html_supports = reconstruct_supports($supports);
		if(!empty($html_supports)){
			?>				
			$('.record-card #support_id').closest('.base').remove();
			$('.record-card fieldset#7 .clone-action').before("<?= $html_supports ?>");

			$('#capacity_building').val("<?= $capacity_building ?>").trigger('change');				
			<?php
		}
		?>
			$('#capacity_building').val("<?= $capacity_building ?>").trigger('change');				
		<?php
	?>
	
	<?php
		require_once("commons/speculation_form_effect.php");
		$speculations = $collect['speculation'];
		$html_speculations = reconstruct_speculations($speculations);
		if(!empty($html_speculations)){
			?>				
			$('.record-card #speculation_id').closest('.base').remove();
			$('.record-card fieldset#4 .clone-action').before("<?= $html_speculations ?>");
			<?php
		}
	?>
	
	<?php
		require_once("commons/credit_form_effect.php");
		$credits = $collect['credit'];
		$html_credits = reconstruct_credits($credits);
		$credit_request = getTrueOrFalse($collect['credit_request']);

		if(!empty($html_credits)){
			?>
			$('.record-card #credit_id').closest('.base').remove();
			$('.record-card fieldset#6').append("<?= $html_credits ?>");
			<?php
		}
		?>
			$('#credit_request').val("<?= $credit_request ?>").trigger('change');				
		<?php
		foreach($credits as $credit){
			$credit_request_ok = getTrueOrFalse($credit['credit_request_ok']);
		?>
		$("#credit_request_ok").on('change',function(){
			if($(this).val() == "false"){
				$("#credit_ok_details").hide();
			}else if($(this).val() == "true"){
				$("#credit_ok_details").show();
			}
		});
		$('#credit_request_ok').val("<?= $credit_request_ok ?>").trigger('change');				
		<?php
		}
	?>
	
	<?php
		require_once("commons/employee_form_effect.php");
		$employees = $collect['employee'];
		$employee_count = $collect['employee_count'];
		$html_employees = reconstruct_employees($employees);
		?>
			$('#employee_count').val("<?= $employee_count ?>");	
		<?php
		if(!empty($html_employees)){
			?>				
			$('.record-card #employee_id').closest('.base').remove();
			$('.record-card fieldset#5 #employees').html("<?= $html_employees ?>");

			$('#employees').show();			
			<?php
		}
	?>

});
</script>